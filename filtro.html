<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Cota√ß√£o - Mercado Couto</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background-color: #f4f7fc;
      margin: 0;
      padding: 20px;
    }

    h1 {
      text-align: center;
      color: #f39c12;
      font-size: 2rem;
      margin-bottom: 20px;
    }

    .container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
    }

    .fornecedor-box {
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      width: 100%;
      max-width: 400px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .fornecedor-box h3 {
      color: #e67e22;
      margin-bottom: 10px;
    }

    .fornecedor-box ul {
      list-style: none;
      padding: 0;
      margin-bottom: 20px;
    }

    .fornecedor-box ul li {
      background: #fafafa;
      margin: 10px 0;
      padding: 10px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    }

    .fornecedor-box ul li strong {
      color: #2c3e50;
    }

    .total-price {
      font-weight: bold;
      color: #e74c3c;
      text-align: center;
      margin-top: 10px;
    }

    .whatsapp-btn {
      display: block;
      background-color: #25d366;
      color: #fff;
      text-align: center;
      padding: 12px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: bold;
      margin-top: 15px;
    }

    .whatsapp-btn:hover {
      background-color: #128c7e;
    }

    .filter-container {
      margin-bottom: 30px;
      text-align: center;
    }

    .filter-container input {
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      width: 250px;
      font-size: 1rem;
    }

    .filter-container button {
      padding: 10px 15px;
      background-color: #f39c12;
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      margin-left: 10px;
    }

    .filter-container button:hover {
      background-color: #e67e22;
    }
  </style>
</head>
<body>

  <h1>üõí Cota√ß√£o Mercado Couto</h1>

  <div class="filter-container">
    <input type="text" id="searchInput" placeholder="Pesquisar por produto..." />
    <button onclick="filterData()">Filtrar</button>
  </div>

  <div class="container" id="fornecedorContainer">
    <!-- As caixas de fornecedores ser√£o geradas aqui dinamicamente -->
  </div>

  <script>
    const dados = [
      {
        empresa: "Atlas Rio",
        entrega: "2025-05-16",
        itens: [
          { produto: "arroz 1kg", marca: "RECKIT vanish sach√™ refil 500ml", qtd: 6, valorUnit: 6.29 },
          { produto: "arroz 1kg", marca: "Leite condensado TP tri√¢ngulo", qtd: 27, valorUnit: 4.99 },
          { produto: "Leite ninho lata", marca: "Nestl√©", qtd: 24, valorUnit: 15.95 },
          { produto: "caf√© 250g", marca: "Uni√£o", qtd: 10, valorUnit: 15.99 }
        ]
      },
      {
        empresa: "Menezes",
        entrega: "2025-05-17",
        itens: [
          { produto: "arroz 1kg", marca: "Leite Mo√ßa", qtd: 15, valorUnit: 5.49 },
          { produto: "Leite ninho lata", marca: "Nestl√©", qtd: 12, valorUnit: 16.99 },
          { produto: "caf√© 250g", marca: "Caf√© Pil√£o", qtd: 8, valorUnit: 12.99 }
        ]
      }
    ];

    function generateFornecedorBoxes() {
      const container = document.getElementById('fornecedorContainer');
      container.innerHTML = ''; // Limpa o conte√∫do atual

      dados.forEach((fornecedorData) => {
        const { empresa, entrega, itens } = fornecedorData;

        // Filtra os melhores pre√ßos, sem repetir os itens
        const itemsMap = {};
        const bestItems = itens.filter(item => {
          const key = `${item.produto} - ${item.marca}`;
          if (!itemsMap[key]) {
            itemsMap[key] = item;
            return true;
          }
          return false;
        });

        // Cria√ß√£o da caixa de fornecedor
        const box = document.createElement('div');
        box.classList.add('fornecedor-box');

        const title = document.createElement('h3');
        title.textContent = empresa;
        box.appendChild(title);

        const entregaText = document.createElement('p');
        entregaText.textContent = `Entrega: ${entrega}`;
        box.appendChild(entregaText);

        const list = document.createElement('ul');
        let total = 0;
        bestItems.forEach(item => {
          const subtotal = item.qtd * item.valorUnit;
          total += subtotal;

          const listItem = document.createElement('li');
          listItem.innerHTML = `
            <strong>${item.produto}</strong><br>
            Marca: ${item.marca}<br>
            Quantidade: ${item.qtd}<br>
            Valor unit√°rio: R$ ${item.valorUnit.toFixed(2)}<br>
            Subtotal: R$ ${subtotal.toFixed(2)}
          `;
          list.appendChild(listItem);
        });

        box.appendChild(list);

        const totalPrice = document.createElement('div');
        totalPrice.classList.add('total-price');
        totalPrice.textContent = `Total geral: R$ ${total.toFixed(2)}`;
        box.appendChild(totalPrice);

        const whatsappButton = document.createElement('a');
        whatsappButton.href = `https://wa.me/5521992576333?text=${encodeURIComponent(generateMessage(empresa, entrega, bestItems, total))}`;
        whatsappButton.classList.add('whatsapp-btn');
        whatsappButton.textContent = "Compartilhar via WhatsApp";
        box.appendChild(whatsappButton);

        container.appendChild(box);
      });
    }

    function generateMessage(empresa, entrega, items, total) {
      let message = `üõí *Cota√ß√£o Mercado Couto*\n\n*Empresa:* ${empresa}\n*Entrega:* ${entrega}\n\n`;
      items.forEach(item => {
        const subtotal = item.qtd * item.valorUnit;
        message += `üì¶ *${item.produto}*\nMarca: ${item.marca}\nQtd: ${item.qtd}\nValor unit√°rio: R$ ${item.valorUnit.toFixed(2)}\nSubtotal: R$ ${subtotal.toFixed(2)}\n\n`;
      });
      message += `*Total geral:* R$ ${total.toFixed(2)}`;
      return message;
    }

    function filterData() {
      const searchInput = document.getElementById('searchInput').value.toLowerCase();
      const filteredData = dados.map(fornecedor => {
        const filteredItems = fornecedor.itens.filter(item =>
          item.produto.toLowerCase().includes(searchInput) || item.marca.toLowerCase().includes(searchInput)
        );
        return { ...fornecedor, itens: filteredItems };
      }).filter(fornecedor => fornecedor.itens.length > 0);

      updateFornecedorBoxes(filteredData);
    }

    function updateFornecedorBoxes(filteredData) {
      const container = document.getElementById('fornecedorContainer');
      container.innerHTML = ''; // Limpa o conte√∫do atual

      filteredData.forEach((fornecedorData) => {
        const { empresa, entrega, itens } = fornecedorData;

        // Filtra os melhores pre√ßos, sem repetir os itens
        const itemsMap = {};
        const bestItems = itens.filter(item => {
          const key = `${item.produto} - ${item.marca}`;
          if (!itemsMap[key]) {
            itemsMap[key] = item;
            return true;
          }
          return false;
        });

        // Cria√ß√£o da caixa de fornecedor
        const box = document.createElement('div');
        box.classList.add('fornecedor-box');

        const title = document.createElement('h3');
        title.textContent = empresa;
        box.appendChild(title);

        const entregaText = document.createElement('p');
        entregaText.textContent = `Entrega: ${entrega}`;
        box.appendChild(entregaText);

        const list = document.createElement('ul');
        let total = 0;
        bestItems.forEach(item => {
          const subtotal = item.qtd * item.valorUnit;
          total += subtotal;

          const listItem = document.createElement('li');
          listItem.innerHTML = `
            <strong>${item.produto}</strong><br>
            Marca: ${item.marca}<br>
            Quantidade: ${item.qtd}<br>
            Valor unit√°rio: R$ ${item.valorUnit.toFixed(2)}<br>
            Subtotal: R$ ${subtotal.toFixed(2)}
          `;
          list.appendChild(listItem);
        });

        box.appendChild(list);

        const totalPrice = document.createElement('div');
        totalPrice.classList.add('total-price');
        totalPrice.textContent = `Total geral: R$ ${total.toFixed(2)}`;
        box.appendChild(totalPrice);

        const whatsappButton = document.createElement('a');
        whatsappButton.href = `https://wa.me/5521992576333?text=${encodeURIComponent(generateMessage(empresa, entrega, bestItems, total))}`;
        whatsappButton.classList.add('whatsapp-btn');
        whatsappButton.textContent = "Compartilhar via WhatsApp";
        box.appendChild(whatsappButton);

        container.appendChild(box);
      });
    }

    // Inicializa com os dados completos
    generateFornecedorBoxes();
  </script>

</body>
</html>
